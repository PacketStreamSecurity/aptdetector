""":class:`BaseAnalyser` contains abstract malware analyser functionality"""
from aptdetector.utils.typecheck import params, returns
from abc import ABCMeta, abstractmethod


class BaseAnalayser(metaclass=ABCMeta):
    """an abstract class to illustrate simple malware analyser"""

    def __init__(self, address):
        """initialize :class:`BaseAnalyser`"""
        self.__validate_ssl = True
        self.__ssl_enabled = True
        self.__address = address
        self.supported_hash = []

    @property
    @returns(bool)
    def validateSSL(self):
        """verify ssl certificate or not"""
        return self.__validate_ssl

    @validateSSL.setter
    @params(self=object, value=bool)
    def validateSSL(self, value):
        self.__validate_ssl = value

    @property
    @returns(bool)
    def sslEnabled(self):
        """connect to server using ssl or not"""
        return self.__ssl_enabled

    @sslEnabled.setter
    @params(self=object, value=bool)
    def sslEnabled(self, value):
        self.__ssl_enabled = value

    @property
    @returns(bool)
    def serverAddress(self):
        """server url address"""
        return self.__address

    @serverAddress.setter
    @params(self=object, value=str)
    def serverAddress(self, value):
        self.__address = value

    @abstractmethod
    def serverStatus(self):
        """server status"""
        pass

    @returns(str)
    @params(self=object, hash=str)
    def hash_type(self, hash):
        """figure out type of the hash"""
        if hash.isalnum() is False or len(hash) < 8 or len(hash) > 128:
            print("wrong type of hash was given")
            hash_type = None

        if len(hash) == 8:
            # it is a CRC hash
            hash_type = "crc"
        elif len(hash) == 32:
            # it is a md5 hash
            hash_type = "md5"
        elif len(hash) == 40:
            # it is a sha1 hash
            hash_type = "sha1"
        elif len(hash) == 64:
            # it is a sha256 hash
            hash_type = "sha256"
        elif len(hash) == 128:
            # it is a sha512 hash
            hash_type = "sha512"

        return hash_type
